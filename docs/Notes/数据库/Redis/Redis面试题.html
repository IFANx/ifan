<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis面试 - redis问题总结 | Notes</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="办法总比问题多">
    
    <link rel="preload" href="/ifan/assets/css/0.styles.9066d5db.css" as="style"><link rel="preload" href="/ifan/assets/js/app.8404088c.js" as="script"><link rel="preload" href="/ifan/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/ifan/assets/js/74.15178ce0.js" as="script"><link rel="prefetch" href="/ifan/assets/js/10.79d5a438.js"><link rel="prefetch" href="/ifan/assets/js/100.16b68609.js"><link rel="prefetch" href="/ifan/assets/js/101.ee6fb75d.js"><link rel="prefetch" href="/ifan/assets/js/102.72f27379.js"><link rel="prefetch" href="/ifan/assets/js/11.b481b7e3.js"><link rel="prefetch" href="/ifan/assets/js/12.64333ff2.js"><link rel="prefetch" href="/ifan/assets/js/13.d6c3ca02.js"><link rel="prefetch" href="/ifan/assets/js/14.390935c0.js"><link rel="prefetch" href="/ifan/assets/js/15.c7bf4d4f.js"><link rel="prefetch" href="/ifan/assets/js/16.545e7617.js"><link rel="prefetch" href="/ifan/assets/js/17.52b247ff.js"><link rel="prefetch" href="/ifan/assets/js/18.1a940620.js"><link rel="prefetch" href="/ifan/assets/js/19.d31a21e7.js"><link rel="prefetch" href="/ifan/assets/js/20.0e57ebcb.js"><link rel="prefetch" href="/ifan/assets/js/21.e4d3eb9f.js"><link rel="prefetch" href="/ifan/assets/js/22.33e351df.js"><link rel="prefetch" href="/ifan/assets/js/23.b5f26c5f.js"><link rel="prefetch" href="/ifan/assets/js/24.25c61120.js"><link rel="prefetch" href="/ifan/assets/js/25.b220adeb.js"><link rel="prefetch" href="/ifan/assets/js/26.90259e3b.js"><link rel="prefetch" href="/ifan/assets/js/27.3e698f68.js"><link rel="prefetch" href="/ifan/assets/js/28.989a3a4f.js"><link rel="prefetch" href="/ifan/assets/js/29.157d2558.js"><link rel="prefetch" href="/ifan/assets/js/3.abc0fc7e.js"><link rel="prefetch" href="/ifan/assets/js/30.5a0fe6f3.js"><link rel="prefetch" href="/ifan/assets/js/31.21730518.js"><link rel="prefetch" href="/ifan/assets/js/32.2a685d63.js"><link rel="prefetch" href="/ifan/assets/js/33.f7d48de2.js"><link rel="prefetch" href="/ifan/assets/js/34.2a08eef0.js"><link rel="prefetch" href="/ifan/assets/js/35.49883a6b.js"><link rel="prefetch" href="/ifan/assets/js/36.5cdf7c9c.js"><link rel="prefetch" href="/ifan/assets/js/37.92b7c857.js"><link rel="prefetch" href="/ifan/assets/js/38.de0727c0.js"><link rel="prefetch" href="/ifan/assets/js/39.07a490c1.js"><link rel="prefetch" href="/ifan/assets/js/4.d12742be.js"><link rel="prefetch" href="/ifan/assets/js/40.e2d55b45.js"><link rel="prefetch" href="/ifan/assets/js/41.f3e9f27b.js"><link rel="prefetch" href="/ifan/assets/js/42.9b3ce7f9.js"><link rel="prefetch" href="/ifan/assets/js/43.98ddf35b.js"><link rel="prefetch" href="/ifan/assets/js/44.15eac3b3.js"><link rel="prefetch" href="/ifan/assets/js/45.f2c75d5f.js"><link rel="prefetch" href="/ifan/assets/js/46.8ae46583.js"><link rel="prefetch" href="/ifan/assets/js/47.b4acaf1f.js"><link rel="prefetch" href="/ifan/assets/js/48.6d6adf74.js"><link rel="prefetch" href="/ifan/assets/js/49.ba295b07.js"><link rel="prefetch" href="/ifan/assets/js/5.216cae74.js"><link rel="prefetch" href="/ifan/assets/js/50.93b74cc2.js"><link rel="prefetch" href="/ifan/assets/js/51.922c4a4a.js"><link rel="prefetch" href="/ifan/assets/js/52.c37fb6fb.js"><link rel="prefetch" href="/ifan/assets/js/53.ab33bb49.js"><link rel="prefetch" href="/ifan/assets/js/54.925cc9f8.js"><link rel="prefetch" href="/ifan/assets/js/55.c277b13f.js"><link rel="prefetch" href="/ifan/assets/js/56.59b279ae.js"><link rel="prefetch" href="/ifan/assets/js/57.0362fe11.js"><link rel="prefetch" href="/ifan/assets/js/58.03f48d64.js"><link rel="prefetch" href="/ifan/assets/js/59.6707bb15.js"><link rel="prefetch" href="/ifan/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/ifan/assets/js/60.377bacbf.js"><link rel="prefetch" href="/ifan/assets/js/61.38370e88.js"><link rel="prefetch" href="/ifan/assets/js/62.54b27491.js"><link rel="prefetch" href="/ifan/assets/js/63.bf05897b.js"><link rel="prefetch" href="/ifan/assets/js/64.4560bd81.js"><link rel="prefetch" href="/ifan/assets/js/65.24ca0fbc.js"><link rel="prefetch" href="/ifan/assets/js/66.419b11f8.js"><link rel="prefetch" href="/ifan/assets/js/67.14ff65ee.js"><link rel="prefetch" href="/ifan/assets/js/68.1e752754.js"><link rel="prefetch" href="/ifan/assets/js/69.c8348371.js"><link rel="prefetch" href="/ifan/assets/js/7.9b5ec1cb.js"><link rel="prefetch" href="/ifan/assets/js/70.0dba163f.js"><link rel="prefetch" href="/ifan/assets/js/71.6928e311.js"><link rel="prefetch" href="/ifan/assets/js/72.e637b7d0.js"><link rel="prefetch" href="/ifan/assets/js/73.f5c83273.js"><link rel="prefetch" href="/ifan/assets/js/75.f1f80645.js"><link rel="prefetch" href="/ifan/assets/js/76.a6c2314d.js"><link rel="prefetch" href="/ifan/assets/js/77.a42621be.js"><link rel="prefetch" href="/ifan/assets/js/78.06f2d516.js"><link rel="prefetch" href="/ifan/assets/js/79.5f1f996e.js"><link rel="prefetch" href="/ifan/assets/js/8.5fa9a4d8.js"><link rel="prefetch" href="/ifan/assets/js/80.66dba44f.js"><link rel="prefetch" href="/ifan/assets/js/81.d725911b.js"><link rel="prefetch" href="/ifan/assets/js/82.7d7062a8.js"><link rel="prefetch" href="/ifan/assets/js/83.a71ad082.js"><link rel="prefetch" href="/ifan/assets/js/84.0d1f2611.js"><link rel="prefetch" href="/ifan/assets/js/85.be611838.js"><link rel="prefetch" href="/ifan/assets/js/86.2bdd958c.js"><link rel="prefetch" href="/ifan/assets/js/87.c31e7630.js"><link rel="prefetch" href="/ifan/assets/js/88.636db1ad.js"><link rel="prefetch" href="/ifan/assets/js/89.c9031d21.js"><link rel="prefetch" href="/ifan/assets/js/9.02ddb301.js"><link rel="prefetch" href="/ifan/assets/js/90.8c41143f.js"><link rel="prefetch" href="/ifan/assets/js/91.33969a76.js"><link rel="prefetch" href="/ifan/assets/js/92.e7009e2a.js"><link rel="prefetch" href="/ifan/assets/js/93.ff9902be.js"><link rel="prefetch" href="/ifan/assets/js/94.a7687ed6.js"><link rel="prefetch" href="/ifan/assets/js/95.360cdf17.js"><link rel="prefetch" href="/ifan/assets/js/96.6311231f.js"><link rel="prefetch" href="/ifan/assets/js/97.e9d7cf84.js"><link rel="prefetch" href="/ifan/assets/js/98.417ffc0b.js"><link rel="prefetch" href="/ifan/assets/js/99.9c2eaa5a.js">
    <link rel="stylesheet" href="/ifan/assets/css/0.styles.9066d5db.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/ifan/" class="home-link router-link-active"><!----> <span class="site-name">Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/ifan/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="what?" class="dropdown-title"><span class="title">what?</span> <span class="arrow down"></span></button> <button type="button" aria-label="what?" class="mobile-dropdown-title"><span class="title">what?</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/IFANx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/IFANx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/ifan/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="what?" class="dropdown-title"><span class="title">what?</span> <span class="arrow down"></span></button> <button type="button" aria-label="what?" class="mobile-dropdown-title"><span class="title">what?</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/IFANx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/IFANx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JVM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Maven</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>软件测试相关</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Redis</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ifan/Notes/数据库/Redis/持久化篇.html" class="sidebar-link">持久化篇</a></li><li><a href="/ifan/Notes/数据库/Redis/缓存一执行问题.html" class="sidebar-link">缓存一执行问题</a></li><li><a href="/ifan/Notes/数据库/Redis/集群-分片技术.html" class="sidebar-link">集群-分片技术</a></li><li><a href="/ifan/Notes/数据库/Redis/数据类型篇.html" class="sidebar-link">数据类型篇</a></li><li><a href="/ifan/Notes/数据库/Redis/Redis面试题.html" class="active sidebar-link">Redis面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#常规问题" class="sidebar-link">常规问题</a></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#数据类型和数据结构" class="sidebar-link">[#](#数据类型和数据结构) 数据类型和数据结构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#为什么redis会设计redisobject对象" class="sidebar-link">为什么Redis会设计redisObject对象</a></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#命令的类型检查和多态" class="sidebar-link">命令的类型检查和多态</a></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#对象共享" class="sidebar-link">对象共享</a></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#引用计数以及对象的消毁" class="sidebar-link">引用计数以及对象的消毁</a></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#小结" class="sidebar-link">小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#持久化和内存" class="sidebar-link">[#](#持久化和内存) 持久化和内存</a></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#事务" class="sidebar-link">[#](#事务) 事务</a></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#集群" class="sidebar-link">[#](#集群) 集群</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#主从复制" class="sidebar-link">[#](#主从复制) 主从复制</a></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#哨兵机制" class="sidebar-link">[#](#哨兵机制) 哨兵机制</a></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#redis集群" class="sidebar-link">[#](#redis集群) Redis集群</a></li></ul></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#应用场景" class="sidebar-link">[#](#应用场景) 应用场景</a></li><li class="sidebar-sub-header"><a href="/ifan/Notes/数据库/Redis/Redis面试题.html#新版本" class="sidebar-link">[#](#新版本) 新版本</a></li></ul></li><li><a href="/ifan/Notes/数据库/Redis/缓存篇.html" class="sidebar-link">缓存篇</a></li><li><a href="/ifan/Notes/数据库/Redis/高可用篇.html" class="sidebar-link">高可用篇</a></li><li><a href="/ifan/Notes/数据库/Redis/面试篇.html" class="sidebar-link">面试篇</a></li><li><a href="/ifan/Notes/数据库/Redis/功能篇.html" class="sidebar-link">功能篇</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringBoot</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MySQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>操作系统</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Netty</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JUC</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Summary</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java IO</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础和原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Notes</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="redis面试-redis问题总结"><a href="#redis面试-redis问题总结" class="header-anchor">#</a> Redis面试 - redis问题总结</h1> <h2 id="常规问题"><a href="#常规问题" class="header-anchor">#</a> 常规问题</h2> <ul><li><p>什么是redis，为什么要使用它</p> <p>Redis的的是完全开源免费的，遵守BSD协议，是一个高性能的键值数据库。是当前最热门的的的NoSql数据库之一，也被人们称为数据结构服务器。Redis以内存作为数据存储介质，所以读写数据的效率极高，远远超过数据库。以设置和获取一个256字节字符串为例，它的读取速度可高达110000次/s，写速度高达81000次/s。</p> <p>Redis跟memcache不同的是，储存在Redis中的数据是持久化的，断电或重启后，数据也不会丢失。因为Redis的存储分为内存存储、磁盘存储和log文件三部分，重启后，Redis可以从磁盘重新将数据加载到内存中，这些可以通过配置文件对其进行配置，正因为这样，Redis才能实现持久化。</p> <p>Redis支持主从模式，可以配置集群，这样更利于支撑起大型的项目，这也是Redis的一大亮点。
众多语言都支持Redis，因为Redis交换数据快，所以在服务器中常用来存储一些需要频繁调取的数据，这样可以大大节省系统直接读取磁盘来获得数据的I/O开销，更重要的是可以极大提升速度。</p></li> <li><p>redis一般有哪些使用场景</p> <ul><li>缓存</li> <li>数据共享分布式</li> <li>分布式锁</li> <li>全局ID</li> <li>计数器</li> <li>限流</li> <li>位统计</li> <li>购物车</li> <li>用户消息时间线timeline</li> <li><a href="https://cloud.tencent.com/product/cmq?from=20065&amp;from_column=20065" target="_blank" rel="noopener noreferrer">消息队列<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>抽奖</li> <li>点赞、签到、打卡</li> <li>商品标签</li> <li>商品筛选</li> <li>用户关注、推荐模型</li> <li>排行榜</li></ul></li> <li><p>redis为什么快</p> <p>Redis是基于内存存储实现的数据库，相对于数据存在磁盘的数据库，就省去磁盘磁盘I/O的消耗。 MySQL等磁盘数据库，需要建立索引来加快查询效率，而<strong>Redis数据存放在内存，直接操作内存，所以就很快</strong>。</p></li></ul> <h2 id="数据类型和数据结构"><a href="#数据类型和数据结构" class="header-anchor">#</a> <a href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84">#</a> 数据类型和数据结构</h2> <ul><li><p>redis有哪些数据类型</p> <p>string（字符串），hash（哈希），list（列表），set（集合）及zset(sorted set：有序集合)</p></li> <li><p>redis数据类型有哪些命令</p></li> <li><p>谈谈redis的对象机制（redisObject)</p> <p>https://developer.aliyun.com/article/937283</p> <p>Redis内部使用一个redisObject对象来表示所有的key和value，redisObject最主要的信息如上图所示：type代表一个value对象具体是何种数据类型，encoding是不同数据类型在redis内部的存储方式，比如：type=string代表value存储的是一个普通字符串，那么对应的encoding可以是raw或者是int，如果是int则代表实际redis内部是按数值型类存储和表示这个字符串的，当然前提是这个字符串本身可以用数值表示，比如:&quot;123&quot; &quot;456&quot;这样的字符串。</p></li></ul> <p><img src="https://ucc.alicdn.com/pic/developer-ecology/1eeab7e333f240e6bab04c5de72e6ebe.png" alt="img"></p> <p>Redis的每种对象其实都由<strong>对象结构(redisObject)</strong> 与 <strong>对应编码的数据结构</strong>组合而成，而每种对象类型对应若干编码方式，不同的编码方式所对应的底层数据结构是不同的。</p> <p><strong>所以，我们需要从几个个角度来着手底层研究：</strong></p> <ul><li><strong>对象设计机制</strong>: 对象结构(redisObject)</li> <li><strong>编码类型和底层数据结构</strong>: 对应编码的数据结构</li></ul> <h3 id="为什么redis会设计redisobject对象"><a href="#为什么redis会设计redisobject对象" class="header-anchor">#</a> 为什么Redis会设计redisObject对象</h3> <blockquote><p>为什么Redis会设计redisObject对象？</p></blockquote> <p>在redis的命令中，用于对键进行处理的命令占了很大一部分，而对于键所保存的值的类型（键的类型），键能执行的命令又各不相同。如： LPUSH 和 LLEN 只能用于列表键, 而 SADD 和SRANDMEMBER 只能用于集合键, 等等; 另外一些命令, 比如 DEL、 TTL 和 TYPE, 可以用于任何类型的键；但是要正确实现这些命令, 必须为不同类型的键设置不同的处理方式: 比如说, 删除一个列表键和删除一个字符串键的操作过程就不太一样。</p> <p>以上的描述说明, <strong>Redis 必须让每个键都带有类型信息, 使得程序可以检查键的类型, 并为它选择合适的处理方式</strong>.</p> <p>比如说， 集合类型就可以由字典和整数集合两种不同的数据结构实现， 但是， 当用户执行 ZADD 命令时， 他/她应该不必关心集合使用的是什么编码， 只要 Redis 能按照 ZADD 命令的指示， 将新元素添加到集合就可以了。</p> <p>这说明, <strong>操作数据类型的命令除了要对键的类型进行检查之外, 还需要根据数据类型的不同编码进行多态处理</strong>.</p> <p>为了解决以上问题, <strong>Redis 构建了自己的类型系统</strong>, 这个系统的主要功能包括:</p> <ul><li>redisObject 对象.</li> <li>基于 redisObject 对象的类型检查.</li> <li>基于 redisObject 对象的显式多态函数.</li> <li>对 redisObject 进行分配、共享和销毁的机制.</li></ul> <h3 id="命令的类型检查和多态"><a href="#命令的类型检查和多态" class="header-anchor">#</a> 命令的类型检查和多态</h3> <blockquote><p>那么Redis是如何处理一条命令的呢？</p></blockquote> <p><strong>当执行一个处理数据类型命令的时候，redis执行以下步骤</strong></p> <ul><li>根据给定的key，在数据库字典中查找和它相对应的redisObject，如果没找到，就返回NULL；</li> <li>检查redisObject的type属性和执行命令所需的类型是否相符，如果不相符，返回类型错误；</li> <li>根据redisObject的encoding属性所指定的编码，选择合适的操作函数来处理底层的数据结构；</li> <li>返回数据结构的操作结果作为命令的返回值。</li></ul> <p><strong>比如现在执行LPOP命令：</strong></p> <p><img src="https://ucc.alicdn.com/pic/developer-ecology/ee1a6eed29f648e19ece8a813834442b.png" alt="a99ff29726fc3125851e17a891c212c4.png"></p> <h3 id="对象共享"><a href="#对象共享" class="header-anchor">#</a> 对象共享</h3> <blockquote><p>redis一般会把一些常见的值放到一个共享对象中，这样可使程序避免了重复分配的麻烦，也节约了一些CPU时间。</p></blockquote> <p><strong>redis预分配的值对象如下</strong>：</p> <ul><li>各种命令的返回值，比如成功时返回的OK，错误时返回的ERROR，命令入队失误时返回的QUEUE，等等</li> <li>包括0 在内，小于REDIS_SHARED_INTEGERS的所有整数（REDIS_SHARED_INTEGERS的默认值是10000）</li></ul> <p><img src="https://ucc.alicdn.com/pic/developer-ecology/941396fb04bc4480b11441c38de5252a.png" alt="9492c4f73652985f6c4dd3dd2f5de02f.png"></p> <blockquote><p>注意：共享对象只能被字典和双向链表这类能带有指针的数据结构使用。像整数集合和压缩列表这些只能保存字符串、整数等自勉之的内存数据结构</p></blockquote> <p><strong>为什么redis不共享列表对象、哈希对象、集合对象、有序集合对象，只共享字符串对象</strong>？</p> <ul><li>列表对象、哈希对象、集合对象、有序集合对象，本身可以包含字符串对象，复杂度较高。</li> <li>如果共享对象是保存字符串对象，那么验证操作的复杂度为O(1)</li> <li>如果共享对象是保存字符串值的字符串对象，那么验证操作的复杂度为O(N)</li> <li>如果共享对象是包含多个值的对象，其中值本身又是字符串对象，即其它对象中嵌套了字符串对象，比如列表对象、哈希对象，那么验证操作的复杂度将会是O(N的平方)</li></ul> <p>如果对复杂度较高的对象创建共享对象，需要消耗很大的CPU，用这种消耗去换取内存空间，是不合适的</p> <h3 id="引用计数以及对象的消毁"><a href="#引用计数以及对象的消毁" class="header-anchor">#</a> 引用计数以及对象的消毁</h3> <blockquote><p>redisObject中有refcount属性，是对象的引用计数，显然计数0那么就是可以回收。</p></blockquote> <ul><li>每个redisObject结构都带有一个refcount属性，指示这个对象被引用了多少次；</li> <li>当新创建一个对象时，它的refcount属性被设置为1；</li> <li>当对一个对象进行共享时，redis将这个对象的refcount加一；</li> <li>当使用完一个对象后，或者消除对一个对象的引用之后，程序将对象的refcount减一；</li> <li>当对象的refcount降至0 时，这个RedisObject结构，以及它引用的数据结构的内存都会被释放。</li></ul> <h3 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h3> <ul><li><p>redis使用自己实现的对象机制（redisObject)来实现类型判断、命令多态和基于引用次数的垃圾回收；</p></li> <li><p>redis会预分配一些常用的数据对象，并通过共享这些对象来减少内存占用，和避免频繁的为小对象分配内存。</p></li> <li><p>redis数据类型有哪些底层数据结构</p></li></ul> <p>​		简单动态字符串（SDS）链表 字典 跳跃表 整数集合 压缩列表</p> <ul><li><p>为什么要设计sds？</p></li> <li><p>一个字符串类型的值能存储最大容量是多少？512M</p></li> <li><p>为什么会设计Stream</p> <p>Redis5.0 中还增加了一个数据结构Stream，从字面上看是流类型，但其实从功能上看，应该是Redis对消息队列（MQ，Message Queue）的完善实现。</p> <p>用过Redis做消息队列的都了解，基于Reids的消息队列实现有很多种，例如：</p> <ul><li><p>PUB/SUB，订阅/发布模式</p> <ul><li>但是发布订阅模式是无法持久化的，如果出现网络断开、Redis 宕机等，消息就会被丢弃；</li></ul></li> <li><p>基于</p> <p>List LPUSH+BRPOP</p> <p>或者</p> <p>基于Sorted-Set</p> <p>的实现</p> <ul><li>支持了持久化，但是不支持多播，分组消费等</li></ul></li></ul> <p>为什么上面的结构无法满足广泛的MQ场景？ 这里便引出一个核心的问题：如果我们期望设计一种数据结构来实现消息队列，最重要的就是要理解<strong>设计一个消息队列需要考虑什么</strong>？初步的我们很容易想到</p> <ul><li>消息的生产</li> <li>消息的消费
<ul><li>单播和多播（多对多）</li> <li>阻塞和非阻塞读取</li></ul></li> <li>消息有序性</li> <li>消息的持久化</li></ul></li> <li><p>Stream用在什么样场景</p></li> <li><p>消息ID的设计是否考虑了时间回拨的问题</p></li></ul> <h2 id="持久化和内存"><a href="#持久化和内存" class="header-anchor">#</a> <a href="#%E6%8C%81%E4%B9%85%E5%8C%96%E5%92%8C%E5%86%85%E5%AD%98">#</a> 持久化和内存</h2> <ul><li>Redis 的持久化机制是什么？各自的优缺点？一般怎么用？</li> <li>Redis 过期键的删除策略有哪些</li> <li>Redis 内存淘汰算法有哪些</li> <li>Redis的内存用完了会发生什么？ 如果达到设置的上限，Redis的写命令会返回错误信息（但是读命令还可以正常返回。）或者你可以配置内存淘汰机制，当Redis达到内存上限时会冲刷掉旧的内容。</li> <li>Redis如何做内存优化？</li> <li>Redis key 的过期时间和永久有效分别怎么设置？</li></ul> <p>EXPIRE 和 PERSIST 命令</p> <ul><li>Redis 中的管道有什么用？</li></ul> <p>一次请求/响应服务器能实现处理新的请求即使旧的请求还未被响应，这样就可以将多个命令发送到服务器，而不用等待回复，最后在一个步骤中读取该答复。</p> <p>这就是管道（pipelining），是一种几十年来广泛使用的技术。例如许多 POP3 协议已经实现支持这个功能，大大加快了从服务器下载新邮件的过程。</p> <h2 id="事务"><a href="#事务" class="header-anchor">#</a> <a href="#%E4%BA%8B%E5%8A%A1">#</a> 事务</h2> <ul><li>什么是redis事务</li> <li>Redis事务相关命令</li> <li>Redis事务的三个阶段</li> <li>watch是如何监视实现的呢</li> <li>为什么 Redis 不支持回滚</li> <li>redis 对 ACID的支持性理解</li> <li>Redis事务其他实现</li></ul> <p>基于Lua脚本，Redis可以保证脚本内的命令一次性、按顺序地执行，其同时也不提供事务运行错误的回滚，执行过程中如果部分命令运行错误，剩下的命令还是会继续运行完</p> <p>基于中间标记变量，通过另外的标记变量来标识事务是否执行完成，读取数据时先读取该标记变量判断是否事务执行完成。但这样会需要额外写代码实现，比较繁琐</p> <h2 id="集群"><a href="#集群" class="header-anchor">#</a> <a href="#%E9%9B%86%E7%BE%A4">#</a> 集群</h2> <h3 id="主从复制"><a href="#主从复制" class="header-anchor">#</a> <a href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6">#</a> 主从复制</h3> <ul><li>Redis集群的主从复制模型是怎样的？</li> <li>全量复制的三个阶段？</li> <li>为什么会设计增量复制？</li> <li>增量复制的流程？ 如果在网络断开期间，repl_backlog_size环形缓冲区写满之后，从库是会丢失掉那部分被覆盖掉的数据，还是直接进行全量复制呢？</li> <li>为什么不持久化的主服务器自动重启非常危险呢?</li> <li>为什么主从全量复制使用RDB而不使用AOF？</li> <li>为什么还有无磁盘复制模式？</li> <li>为什么还会有从库的从库的设计？</li></ul> <h3 id="哨兵机制"><a href="#哨兵机制" class="header-anchor">#</a> <a href="#%E5%93%A8%E5%85%B5%E6%9C%BA%E5%88%B6">#</a> 哨兵机制</h3> <ul><li>Redis哨兵机制？哨兵实现了什么功能呢</li> <li>哨兵集群是通过什么方式组建的？</li> <li>哨兵是如何监控Redis集群的？</li> <li>哨兵如何判断主库已经下线了呢？</li> <li>哨兵的选举机制是什么样的？</li> <li>Redis 1主4从，5个哨兵，哨兵配置quorum为2，如果3个哨兵故障，当主库宕机时，哨兵能否判断主库“客观下线”？能否自动切换？</li> <li>主库判定客观下线了，那么如何从剩余的从库中选择一个新的主库呢？</li> <li>新的主库选择出来后，如何进行故障的转移？</li></ul> <h3 id="redis集群"><a href="#redis集群" class="header-anchor">#</a> <a href="#redis%E9%9B%86%E7%BE%A4">#</a> Redis集群</h3> <ul><li>说说Redis哈希槽的概念？为什么是16384个？</li> <li>Redis集群会有写操作丢失吗？为什么？</li></ul> <p>Redis并不能保证数据的强一致性，这意味这在实际中集群在特定的条件下可能会丢失写操作。</p> <h2 id="应用场景"><a href="#应用场景" class="header-anchor">#</a> <a href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">#</a> 应用场景</h2> <ul><li>redis 客户端有哪些</li></ul> <p>Redisson、Jedis、lettuce等等，官方推荐使用Redisson。</p> <p>Redisson是一个高级的分布式协调Redis客服端，能帮助用户在分布式环境中轻松实现一些Java的对象 (Bloom filter, BitSet, Set, SetMultimap, ScoredSortedSet, SortedSet, Map, ConcurrentMap, List, ListMultimap, Queue, BlockingQueue, Deque, BlockingDeque, Semaphore, Lock, ReadWriteLock, AtomicLong, CountDownLatch, Publish / Subscribe, HyperLogLog)。</p> <ul><li>Redis如何做大量数据插入？ Redis2.6开始redis-cli支持一种新的被称之为pipe mode的新模式用于执行大量数据插入工作。</li> <li>redis实现分布式锁实现? 什么是 RedLock?</li> <li>redis缓存有哪些问题，如何解决</li> <li>redis和其它数据库一致性问题如何解决</li> <li>redis性能问题有哪些，如何分析定位解决</li></ul> <h2 id="新版本"><a href="#新版本" class="header-anchor">#</a> <a href="#%E6%96%B0%E7%89%88%E6%9C%AC">#</a> 新版本</h2> <ul><li>Redis单线程模型？ 在6.0之前如何提高多核CPU的利用率？</li></ul> <p>可以在同一个服务器部署多个Redis的实例，并把他们当作不同的服务器来使用，在某些时候，无论如何一个服务器是不够的， 所以，如果你想使用多个CPU，你可以考虑一下分片（shard）。</p> <hr> <p>著作权归@pdai所有 原文链接：https://pdai.tech/md/db/nosql-redis/db-redis-z-mianshi.html</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/ifan/Notes/数据库/Redis/数据类型篇.html" class="prev">
        数据类型篇
      </a></span> <span class="next"><a href="/ifan/Notes/数据库/Redis/缓存篇.html">
        缓存篇
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/ifan/assets/js/app.8404088c.js" defer></script><script src="/ifan/assets/js/2.733019b2.js" defer></script><script src="/ifan/assets/js/74.15178ce0.js" defer></script>
  </body>
</html>
